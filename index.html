<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Meeting Summarizer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; max-width: 800px; }
    textarea, input { width: 100%; margin-top: 6px; padding: 6px; }
    button { margin-top: 10px; padding: 8px 16px; }
    .section { margin-bottom: 20px; }
  </style>
</head>
<body>
  <h2>AI Meeting Summarizer</h2>

  <!-- Transcript upload -->
  <div class="section">
    <h3>Step 1: Paste Transcript</h3>
    <textarea id="transcript" rows="8" placeholder="Paste meeting transcript here..."></textarea>
    <input id="prompt" type="text" placeholder="Custom instruction (optional) e.g. Bullet points for executives">
    <button onclick="generateSummary()">Generate Summary</button>
  </div>

  <!-- Summary editor -->
  <div class="section" id="summary-section" style="display:none;">
    <h3>Step 2: Edit Summary</h3>
    <textarea id="summary" rows="12"></textarea>
    <h3>Step 3: Share via Email</h3>
    <input id="recipients" type="text" placeholder="Comma-separated emails (e.g. alice@example.com, bob@example.com)">
    <button onclick="saveAndShare()">Save & Share</button>
  </div>

  <script>
    // change this to your backend URL after deploy
    const API_BASE = "http://localhost:5000"; 

    let currentId = null;

    async function generateSummary() {
      const transcript = document.getElementById("transcript").value;
      const prompt = document.getElementById("prompt").value;

      if (!transcript.trim()) {
        alert("Please paste a transcript first.");
        return;
      }

      try {
        const res = await fetch(`${API_BASE}/api/summarize`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ transcript, prompt })
        });

        const data = await res.json();
        if (!res.ok) {
          alert(data.error || "Error generating summary");
          return;
        }

        currentId = data.id;
        document.getElementById("summary").value = data.generatedSummary;
        document.getElementById("summary-section").style.display = "block";
      } catch (err) {
        console.error(err);
        alert("Network error");
      }
    }

    async function saveAndShare() {
      const editedSummary = document.getElementById("summary").value;
      const recipients = document.getElementById("recipients").value
        .split(",")
        .map(e => e.trim())
        .filter(Boolean);

      if (!currentId) {
        alert("No summary to save.");
        return;
      }

      try {
        const res = await fetch(`${API_BASE}/api/save-and-share`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ id: currentId, editedSummary, recipients })
        });

        const data = await res.json();
        if (!res.ok) {
          alert(data.error || "Error saving/sharing");
          return;
        }

        alert("Summary saved and shared successfully!");
      } catch (err) {
        console.error(err);
        alert("Network error");
      }
    }
  </script>
</body>
</html>

